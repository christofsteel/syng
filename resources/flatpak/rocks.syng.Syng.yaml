id: rocks.syng.Syng
runtime: org.kde.Platform
runtime-version: '6.7'
sdk: org.kde.Sdk
base: "com.riverbankcomputing.PyQt.BaseApp"
base-version: "6.7"
cleanup-commands:
  - /app/cleanup-BaseApp.sh
build-options:
  env:
    - BASEAPP_REMOVE_WEBENGINE=1
finish-args:
  - --env=QTWEBENGINEPROCESS_PATH=/app/bin/QtWebEngineProcess - /app/cleanup-BaseApp.sh
  # X11 + XShm access
  - --socket=fallback-x11
  - --share=ipc
  - --socket=wayland
  # Acceleration
  - --device=dri
  # Sound
  - --socket=pulseaudio
  # Ability to edit/save files anywhere
  - --filesystem=host
  - --share=network
command: syng
modules:
  - mpv.yaml
  - python3-requirements-client.yaml
  - python3-poetry-core.yaml
  - name: syng
    buildsystem: simple
    build-commands:
      - pip install --prefix=/app --no-deps . --no-build-isolation
      - install -Dm644 resources/${FLATPAK_ID}.desktop -t /app/share/applications
      - install -Dm644 resources/flatpak/${FLATPAK_ID}.metainfo.xml -t /app/share/metainfo
      - install -Dm644 resources/icons/hicolor/32x32/apps/${FLATPAK_ID}.png /app/share/icons/hicolor/32x32/apps/${FLATPAK_ID}.png 
      - install -Dm644 resources/icons/hicolor/48x48/apps/${FLATPAK_ID}.png /app/share/icons/hicolor/48x48/apps/${FLATPAK_ID}.png 
      - install -Dm644 resources/icons/hicolor/64x64/apps/${FLATPAK_ID}.png /app/share/icons/hicolor/64x64/apps/${FLATPAK_ID}.png 
      - install -Dm644 resources/icons/hicolor/128x128/apps/${FLATPAK_ID}.png /app/share/icons/hicolor/128x128/apps/${FLATPAK_ID}.png 
      - install -Dm644 resources/icons/hicolor/256x256/apps/${FLATPAK_ID}.png /app/share/icons/hicolor/256x256/apps/${FLATPAK_ID}.png 
      - install -Dm644 resources/icons/hicolor/512x512/apps/${FLATPAK_ID}.png /app/share/icons/hicolor/512x512/apps/${FLATPAK_ID}.png 
      - install -Dm644 resources/icons/hicolor/scalable/apps/${FLATPAK_ID}.svg /app/share/icons/hicolor/scalable/apps/${FLATPAK_ID}.svg 
    sources:
      - type: git
        url: https://github.com/christofsteel/syng.git
        commit: 58b3837d1bae05abd9b521dac8bed0de3ae2824c

